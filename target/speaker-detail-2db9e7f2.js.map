{"version":3,"file":"speaker-detail-2db9e7f2.js","sources":["../blocks/speaker-detail/speaker-detail.js"],"sourcesContent":["import { getMetadata } from '../../scripts/lib-franklin.js';\nimport { getQueryIndex } from '../../scripts/services/QueryIndex.js';\nimport { append } from '../../scripts/utils/dom.js';\nimport { removeTitleSuffix } from '../../scripts/utils/metadata.js';\nimport { getYearFromPath } from '../../scripts/utils/path.js';\nimport { getSiteRootPathAlsoForSpeakerPath, getSpeakerOverviewPath } from '../../scripts/utils/site.js';\n\n/**\n * Add speaker metadata.\n * @param {Element} parent\n */\nfunction addSpeakerMetadata(parent) {\n  const h1 = parent.querySelector('h1');\n  if (!h1) {\n    return;\n  }\n\n  const div = document.createElement('div');\n  div.classList.add('speaker-data');\n  h1.insertAdjacentElement('afterend', div);\n\n  const twitter = getMetadata('twitter');\n  if (twitter) {\n    const twitterDiv = append(div, 'div', 'twitter');\n    const a = append(twitterDiv, 'a');\n    a.href = `https://twitter.com/${twitter}`;\n    a.textContent = twitter;\n  }\n\n  const affiliation = getMetadata('affiliation');\n  if (affiliation) {\n    const affiliationDiv = append(div, 'div', 'affiliation');\n    affiliationDiv.textContent = affiliation;\n  }\n}\n\n/**\n * Add a single list of talks.\n * @typedef {import('../../scripts/services/QueryIndexItem').default} QueryIndexItem\n * @param {Element} parent Parent element\n * @param {QueryIndexItem[]} talkItems Talk items\n * @param {string} title Headline title\n */\nfunction addTalkList(parent, talkItems, title) {\n  if (talkItems.length === 0) {\n    return;\n  }\n  append(parent, 'h4').textContent = title;\n  const ul = append(parent, 'ul');\n  talkItems.forEach((item) => {\n    const li = append(ul, 'li');\n    const a = append(li, 'a');\n    a.href = item.path;\n    a.textContent = removeTitleSuffix(item.title);\n    li.append(` (${getYearFromPath(item.path)})`);\n  });\n}\n\n/**\n * Add talk overview.\n * @param {Element} parent\n */\nasync function addTalkOverview(parent) {\n  const queryIndex = await getQueryIndex();\n  const speakerItem = queryIndex.getItem(window.location.pathname);\n  if (!speakerItem) {\n    return;\n  }\n  const talks = queryIndex.getTalksForSpeaker(speakerItem);\n  if (talks.length === 0) {\n    return;\n  }\n  const siteRoot = await getSiteRootPathAlsoForSpeakerPath(\n    window.location.pathname,\n    window.location.hash,\n  );\n\n  const talksThisYear = talks.filter((item) => item.path.indexOf(siteRoot) === 0);\n  const talksOtherYears = talks.filter((item) => item.path.indexOf(siteRoot) !== 0);\n\n  const div = append(parent, 'div', 'talk-list');\n  addTalkList(div, talksThisYear, 'Talks from this year');\n  addTalkList(div, talksOtherYears, 'Talks from other years');\n\n  // back to speaker overview link\n  const p = append(parent, 'p');\n  const backLink = append(p, 'a');\n  backLink.href = getSpeakerOverviewPath(siteRoot);\n  backLink.textContent = 'Back to speaker overview';\n}\n\n/**\n * Speaker Detail.\n * @param {Element} block\n */\nexport default async function decorate(block) {\n  addSpeakerMetadata(block);\n  addTalkOverview(block);\n\n  // react to stage changes via hash\n  window.addEventListener('hashchange', () => {\n    window.location.reload();\n  });\n}\n"],"names":["addTalkList","parent","talkItems","title","length","append","textContent","ul","forEach","item","li","a","href","path","removeTitleSuffix","getYearFromPath","async","decorate","block","h1","querySelector","div","document","createElement","classList","add","insertAdjacentElement","twitter","getMetadata","twitterDiv","affiliation","addSpeakerMetadata","queryIndex","getQueryIndex","speakerItem","getItem","window","location","pathname","talks","getTalksForSpeaker","siteRoot","getSiteRootPathAlsoForSpeakerPath","hash","talksThisYear","filter","indexOf","talksOtherYears","p","backLink","getSpeakerOverviewPath","addTalkOverview","addEventListener","reload"],"mappings":"sEA2CA,SAASA,EAAYC,EAAQC,EAAWC,GACtC,GAAyB,IAArBD,EAAUE,OACZ,OAEFC,EAAOJ,EAAQ,MAAMK,YAAcH,EACnC,MAAMI,EAAKF,EAAOJ,EAAQ,MAC1BC,EAAUM,SAASC,IACjB,MAAMC,EAAKL,EAAOE,EAAI,MAChBI,EAAIN,EAAOK,EAAI,KACrBC,EAAEC,KAAOH,EAAKI,KACdF,EAAEL,YAAcQ,EAAkBL,EAAKN,OACvCO,EAAGL,OAAO,KAAKU,EAAgBN,EAAKI,SAAS,GAEjD,CAuCeG,eAAeC,EAASC,IApFvC,SAA4BjB,GAC1B,MAAMkB,EAAKlB,EAAOmB,cAAc,MAChC,IAAKD,EACH,OAGF,MAAME,EAAMC,SAASC,cAAc,OACnCF,EAAIG,UAAUC,IAAI,gBAClBN,EAAGO,sBAAsB,WAAYL,GAErC,MAAMM,EAAUC,EAAY,WAC5B,GAAID,EAAS,CACX,MAAME,EAAaxB,EAAOgB,EAAK,MAAO,WAChCV,EAAIN,EAAOwB,EAAY,KAC7BlB,EAAEC,KAAO,uBAAuBe,IAChChB,EAAEL,YAAcqB,CACjB,CAED,MAAMG,EAAcF,EAAY,eAC5BE,IACqBzB,EAAOgB,EAAK,MAAO,eAC3Bf,YAAcwB,EAEjC,CA8DEC,CAAmBb,GAlCrBF,eAA+Bf,GAC7B,MAAM+B,QAAmBC,IACnBC,EAAcF,EAAWG,QAAQC,OAAOC,SAASC,UACvD,IAAKJ,EACH,OAEF,MAAMK,EAAQP,EAAWQ,mBAAmBN,GAC5C,GAAqB,IAAjBK,EAAMnC,OACR,OAEF,MAAMqC,QAAiBC,EACrBN,OAAOC,SAASC,SAChBF,OAAOC,SAASM,MAGZC,EAAgBL,EAAMM,QAAQpC,GAAyC,IAAhCA,EAAKI,KAAKiC,QAAQL,KACzDM,EAAkBR,EAAMM,QAAQpC,GAAyC,IAAhCA,EAAKI,KAAKiC,QAAQL,KAE3DpB,EAAMhB,EAAOJ,EAAQ,MAAO,aAClCD,EAAYqB,EAAKuB,EAAe,wBAChC5C,EAAYqB,EAAK0B,EAAiB,0BAGlC,MAAMC,EAAI3C,EAAOJ,EAAQ,KACnBgD,EAAW5C,EAAO2C,EAAG,KAC3BC,EAASrC,KAAOsC,EAAuBT,GACvCQ,EAAS3C,YAAc,0BACzB,CAQE6C,CAAgBjC,GAGhBkB,OAAOgB,iBAAiB,cAAc,KACpChB,OAAOC,SAASgB,QAAQ,GAE5B"}