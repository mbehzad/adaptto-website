{"version":3,"file":"fragment-b6594b46.js","sources":["../blocks/fragment/fragment.js"],"sourcesContent":["/*\n * Fragment Block\n * Include content from one Helix page in another.\n * https://www.hlx.live/developer/block-collection/fragment\n */\nimport { decorateMain } from '../../scripts/scripts.js';\nimport { loadBlocks } from '../../scripts/lib-franklin.js';\nimport { getFetchCacheOptions } from '../../scripts/utils/fetch.js';\n\n/**\n * Loads a fragment.\n * @param {string} path The path to the fragment\n * @returns The root element of the fragment\n */\nasync function loadFragment(path) {\n  if (path && path.startsWith('/')) {\n    const resp = await fetch(`${path}.plain.html`, getFetchCacheOptions());\n    if (resp.ok) {\n      const main = document.createElement('main');\n      main.innerHTML = await resp.text();\n      decorateMain(main, true);\n      await loadBlocks(main);\n      return main;\n    }\n  }\n  return null;\n}\n\nexport default async function decorate(block) {\n  const link = block.querySelector('a');\n  const path = link ? link.getAttribute('href') : block.textContent.trim();\n  const fragment = await loadFragment(path);\n  if (fragment) {\n    const fragmentSection = fragment.querySelector(':scope .section');\n    if (fragmentSection) {\n      block.closest('.section').classList.add(...fragmentSection.classList);\n      block.closest('.fragment-wrapper').replaceWith(...fragmentSection.childNodes);\n    }\n  }\n}\n"],"names":["async","decorate","block","link","querySelector","path","getAttribute","textContent","trim","fragment","startsWith","resp","fetch","getFetchCacheOptions","ok","main","document","createElement","innerHTML","text","decorateMain","loadBlocks","loadFragment","fragmentSection","closest","classList","add","replaceWith","childNodes"],"mappings":"0DA4BeA,eAAeC,EAASC,GACrC,MAAMC,EAAOD,EAAME,cAAc,KAC3BC,EAAOF,EAAOA,EAAKG,aAAa,QAAUJ,EAAMK,YAAYC,OAC5DC,QAjBRT,eAA4BK,GAC1B,GAAIA,GAAQA,EAAKK,WAAW,KAAM,CAChC,MAAMC,QAAaC,MAAM,GAAGP,eAAmBQ,KAC/C,GAAIF,EAAKG,GAAI,CACX,MAAMC,EAAOC,SAASC,cAAc,QAIpC,OAHAF,EAAKG,gBAAkBP,EAAKQ,OAC5BC,EAAaL,GAAM,SACbM,EAAWN,GACVA,CACR,CACF,CACD,OAAO,IACT,CAKyBO,CAAajB,GACpC,GAAII,EAAU,CACZ,MAAMc,EAAkBd,EAASL,cAAc,mBAC3CmB,IACFrB,EAAMsB,QAAQ,YAAYC,UAAUC,OAAOH,EAAgBE,WAC3DvB,EAAMsB,QAAQ,qBAAqBG,eAAeJ,EAAgBK,YAErE,CACH"}