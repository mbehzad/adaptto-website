{"version":3,"file":"footer-032dc22a.js","sources":["../blocks/footer/footer.js"],"sourcesContent":["import { append } from '../../scripts/utils/dom.js';\nimport { addArchiveLinks, getSiteRootPathAlsoForSpeakerPath } from '../../scripts/utils/site.js';\nimport { decorateAnchors } from '../../scripts/services/LinkHandler.js';\nimport { getFetchCacheOptions } from '../../scripts/utils/fetch.js';\n\n/**\n * @param {Element} footerNav\n */\nfunction decorateFooterNav(footerNav) {\n  footerNav.classList.add('section-footernav');\n\n  // add archive links to last footernav item\n  addArchiveLinks(footerNav);\n}\n\n/**\n * Replace text in text nodes.\n * @param {Element} element\n * @param {RegExp} pattern\n * @param {string} replacement\n */\nfunction replaceInText(element, pattern, replacement) {\n  Array.from(element.childNodes).forEach((node) => {\n    switch (node.nodeType) {\n      case Node.ELEMENT_NODE:\n        replaceInText(node, pattern, replacement);\n        break;\n      case Node.TEXT_NODE:\n        node.textContent = node.textContent.replace(pattern, replacement);\n        break;\n      default:\n    }\n  });\n}\n\n/**\n * @param {Element} footerText\n */\nfunction decorateFooterText(footerText) {\n  footerText.classList.add('section-footertext');\n\n  // replace placeholder for current year\n  replaceInText(footerText, /\\$currentYear\\$/g, new Date().getFullYear());\n}\n\n/**\n * Loads and decorates footer and footer navigation.\n * @param {Element} block The footer block element\n */\nexport default async function decorate(block) {\n  block.textContent = '';\n\n  // detect site root\n  // for speaker pages, this year may be derived from hash, or from latest speaker's talk\n  const siteRoot = await getSiteRootPathAlsoForSpeakerPath(\n    window.location.pathname,\n    window.location.hash,\n  );\n\n  // fetch footer content\n  const resp = await fetch(`${siteRoot}footer.plain.html`, getFetchCacheOptions());\n  if (resp.ok) {\n    const html = await resp.text();\n    const container = append(block, 'div');\n    container.innerHTML = html;\n    decorateAnchors(container);\n\n    // first section: footer navigation\n    const footerNav = container.children[0];\n    if (footerNav) {\n      decorateFooterNav(footerNav);\n    }\n\n    // second section: footer text\n    const footerText = container.children[1];\n    if (footerText) {\n      decorateFooterText(footerText);\n    }\n  }\n}\n"],"names":["replaceInText","element","pattern","replacement","Array","from","childNodes","forEach","node","nodeType","Node","ELEMENT_NODE","TEXT_NODE","textContent","replace","decorateFooterText","footerText","classList","add","Date","getFullYear","async","decorate","block","siteRoot","getSiteRootPathAlsoForSpeakerPath","window","location","pathname","hash","resp","fetch","getFetchCacheOptions","ok","html","text","container","append","innerHTML","decorateAnchors","footerNav","children","addArchiveLinks","decorateFooterNav"],"mappings":"wDAqBA,SAASA,EAAcC,EAASC,EAASC,GACvCC,MAAMC,KAAKJ,EAAQK,YAAYC,SAASC,IACtC,OAAQA,EAAKC,UACX,KAAKC,KAAKC,aACRX,EAAcQ,EAAMN,EAASC,GAC7B,MACF,KAAKO,KAAKE,UACRJ,EAAKK,YAAcL,EAAKK,YAAYC,QAAQZ,EAASC,GAGxD,GAEL,CAKA,SAASY,EAAmBC,GAC1BA,EAAWC,UAAUC,IAAI,sBAGzBlB,EAAcgB,EAAY,oBAAoB,IAAIG,MAAOC,cAC3D,CAMeC,eAAeC,EAASC,GACrCA,EAAMV,YAAc,GAIpB,MAAMW,QAAiBC,EACrBC,OAAOC,SAASC,SAChBF,OAAOC,SAASE,MAIZC,QAAaC,MAAM,GAAGP,qBAA6BQ,KACzD,GAAIF,EAAKG,GAAI,CACX,MAAMC,QAAaJ,EAAKK,OAClBC,EAAYC,EAAOd,EAAO,OAChCa,EAAUE,UAAYJ,EACtBK,EAAgBH,GAGhB,MAAMI,EAAYJ,EAAUK,SAAS,GACjCD,GA7DR,SAA2BA,GACzBA,EAAUvB,UAAUC,IAAI,qBAGxBwB,EAAgBF,EAClB,CAyDMG,CAAkBH,GAIpB,MAAMxB,EAAaoB,EAAUK,SAAS,GAClCzB,GACFD,EAAmBC,EAEtB,CACH"}