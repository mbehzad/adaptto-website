{"version":3,"file":"embed-youtube-a380e795.js","sources":["../blocks/embed-youtube/embed-youtube.js"],"sourcesContent":["import html from '../../scripts/utils/htmlTemplateTag.js';\nimport { append } from '../../scripts/utils/dom.js';\nimport { decorateWithConsent } from '../../scripts/utils/usercentrics.js';\n\n// pattern from https://gist.github.com/deunlee/0b45cfacb7e8f788e5bbfa2911f54d3e\nconst youTubeUrlPattern = /^(https?:)?(\\/\\/)?((www\\.|m\\.)?youtube(-nocookie)?\\.com\\/((watch)?\\?(feature=\\w*&)?vi?=|embed\\/|vi?\\/|e\\/)|youtu.be\\/)([\\w-]{10,20})/i;\n\n/**\n * @param {string} vid\n */\nfunction youtubePlayerHtml(vid) {\n  return html`<iframe src=\"https://www.youtube.com/embed/${vid}?rel=0&muted=1&autoplay=1\"\n     allow=\"autoplay; fullscreen; picture-in-picture; encrypted-media; accelerometer; gyroscope; picture-in-picture\"\n     scrolling=\"no\"\n     loading=\"lazy\"></iframe>`;\n}\n\n/**\n * @param {string} vid\n */\nfunction fallbackImageHtml(vid) {\n  return html`<picture>\n      <source media=\"(min-width: 799px)\" srcset=\"https://i.ytimg.com/vi_webp/${vid}/maxresdefault.webp\" type=\"image/webp\">\n      <source media=\"(min-width: 799px)\" srcset=\"https://i.ytimg.com/vi/${vid}/maxresdefault.jpg\" type=\"image/jpeg\">\n      <source srcset=\"https://i.ytimg.com/vi_webp/${vid}/hqdefault.webp\" type=\"image/webp\">\n      <source srcset=\"https://i.ytimg.com/vi/${vid}/hqdefault.jpg\" type=\"image/jpeg\">\n      <img src=\"https://i.ytimg.com/vi/${vid}/maxresdefault.jpg\" alt=\"YouTube Video\">\n    </picture>`;\n}\n\n/**\n * Get YouTube Video ID from URL.\n * @param {string} href\n * @return {string} Video ID\n */\nfunction getYouTubeVideoIdByUrl(url) {\n  const match = url.match(youTubeUrlPattern);\n  if (match) {\n    return match[9];\n  }\n  return undefined;\n}\n\n/**\n * Embed YouTube video player.\n * Display a placeholder with static image first.\n * @param {Element} block\n */\nexport default function decorate(block) {\n  const link = block.querySelector('a')?.href;\n  const vid = getYouTubeVideoIdByUrl(link);\n  if (vid) {\n    block.innerHTML = '';\n    const placeholder = append(block, 'div', 'placeholder');\n    placeholder.innerHTML = `<button title=\"Play\"></button>${fallbackImageHtml(vid)}`;\n    placeholder.addEventListener('click', () => {\n      decorateWithConsent('youtube', block, (parent) => {\n        parent.innerHTML = youtubePlayerHtml(vid);\n      });\n    });\n  }\n}\n"],"names":["youTubeUrlPattern","decorate","block","link","querySelector","href","vid","url","match","getYouTubeVideoIdByUrl","innerHTML","placeholder","append","html","fallbackImageHtml","addEventListener","decorateWithConsent","parent","youtubePlayerHtml"],"mappings":"kIAKA,MAAMA,EAAoB,wIA2CX,SAASC,EAASC,GAC/B,MAAMC,EAAOD,EAAME,cAAc,MAAMC,KACjCC,EAfR,SAAgCC,GAC9B,MAAMC,EAAQD,EAAIC,MAAMR,GACxB,GAAIQ,EACF,OAAOA,EAAM,EAGjB,CAScC,CAAuBN,GACnC,GAAIG,EAAK,CACPJ,EAAMQ,UAAY,GAClB,MAAMC,EAAcC,EAAOV,EAAO,MAAO,eACzCS,EAAYD,UAAY,iCAlC5B,SAA2BJ,GACzB,OAAOO,CAAI;+EACkEP;0EACLA;oDACtBA;+CACLA;yCACNA;eAEzC,CA0B6DQ,CAAkBR,KAC3EK,EAAYI,iBAAiB,SAAS,KACpCC,EAAoB,UAAWd,GAAQe,IACrCA,EAAOP,UA/Cf,SAA2BJ,GACzB,OAAOO,CAAI,8CAA8CP;;;8BAI3D,CA0C2BY,CAAkBZ,EAAI,GACzC,GAEL,CACH"}