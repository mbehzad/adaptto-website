{"version":3,"file":"header-23b74733.js","sources":["../blocks/header/header.js"],"sourcesContent":["import { append, prepend } from '../../scripts/utils/dom.js';\nimport { addArchiveLinks, getSiteRootPathAlsoForSpeakerPath } from '../../scripts/utils/site.js';\nimport { decorateAnchors } from '../../scripts/services/LinkHandler.js';\nimport { getFetchCacheOptions } from '../../scripts/utils/fetch.js';\n\n/**\n * @param {Element} nav\n */\nfunction decorateMainNav(nav) {\n  // mobile navigation\n  const mobileNavH1 = prepend(nav, 'h1', 'mobile-nav');\n  const mobileNavAnchor = append(mobileNavH1, 'a');\n  mobileNavAnchor.href = '#';\n  mobileNavAnchor.text = 'Navigation';\n  mobileNavAnchor.addEventListener('click', (e) => {\n    e.preventDefault();\n    nav.querySelector(':scope > ul')?.classList.toggle('active');\n  });\n\n  // mobile navigation support for mainnav items with sub menus\n  // ensure for those items the link is not followed, but the submenu is shown\n  // (if mobile nav is active)\n  nav.querySelectorAll('li > a').forEach((a) => {\n    const li = a.parentElement;\n    // nav item has sub menu\n    const submenu = li.querySelector(':scope > ul');\n    if (submenu) {\n      a.addEventListener('click', (e) => {\n        if (window.getComputedStyle(mobileNavH1).display !== 'none') {\n          e.preventDefault();\n          submenu.classList.toggle('active');\n        }\n      });\n    }\n  });\n\n  // add archive links to last mainnav item\n  addArchiveLinks(nav);\n}\n\n/**\n * Loads and decorates header and main navigation.\n * @param {Element} block The header block element\n */\nexport default async function decorate(block) {\n  block.textContent = '';\n\n  // detect site root\n  // for speaker pages, this year may be derived from hash, or from latest speaker's talk\n  const siteRoot = await getSiteRootPathAlsoForSpeakerPath(\n    window.location.pathname,\n    window.location.hash,\n  );\n\n  // logo link\n  const logoLink = document.querySelector('header a.logo');\n  if (logoLink) {\n    logoLink.href = siteRoot;\n  }\n\n  // fetch nav content\n  const resp = await fetch(`${siteRoot}nav.plain.html`, getFetchCacheOptions());\n  if (resp.ok) {\n    const html = await resp.text();\n    const container = document.createElement('div');\n    container.innerHTML = html;\n    decorateAnchors(container);\n\n    // first section: title and slogan, second section: main navigation\n    const titles = container.children[0];\n    const mainNav = container.children[1];\n    if (titles) {\n      block.append(...Array.from(titles.childNodes));\n    }\n    if (mainNav) {\n      const nav = append(block, 'nav');\n      nav.append(...Array.from(mainNav.childNodes));\n      decorateMainNav(nav);\n    }\n  }\n}\n"],"names":["async","decorate","block","textContent","siteRoot","getSiteRootPathAlsoForSpeakerPath","window","location","pathname","hash","logoLink","document","querySelector","href","resp","fetch","getFetchCacheOptions","ok","html","text","container","createElement","innerHTML","decorateAnchors","titles","children","mainNav","append","Array","from","childNodes","nav","mobileNavH1","prepend","mobileNavAnchor","addEventListener","e","preventDefault","classList","toggle","querySelectorAll","forEach","a","submenu","parentElement","getComputedStyle","display","addArchiveLinks","decorateMainNav"],"mappings":"+DA4CeA,eAAeC,EAASC,GACrCA,EAAMC,YAAc,GAIpB,MAAMC,QAAiBC,EACrBC,OAAOC,SAASC,SAChBF,OAAOC,SAASE,MAIZC,EAAWC,SAASC,cAAc,iBACpCF,IACFA,EAASG,KAAOT,GAIlB,MAAMU,QAAaC,MAAM,GAAGX,kBAA0BY,KACtD,GAAIF,EAAKG,GAAI,CACX,MAAMC,QAAaJ,EAAKK,OAClBC,EAAYT,SAASU,cAAc,OACzCD,EAAUE,UAAYJ,EACtBK,EAAgBH,GAGhB,MAAMI,EAASJ,EAAUK,SAAS,GAC5BC,EAAUN,EAAUK,SAAS,GAInC,GAHID,GACFtB,EAAMyB,UAAUC,MAAMC,KAAKL,EAAOM,aAEhCJ,EAAS,CACX,MAAMK,EAAMJ,EAAOzB,EAAO,OAC1B6B,EAAIJ,UAAUC,MAAMC,KAAKH,EAAQI,aApEvC,SAAyBC,GAEvB,MAAMC,EAAcC,EAAQF,EAAK,KAAM,cACjCG,EAAkBP,EAAOK,EAAa,KAC5CE,EAAgBrB,KAAO,IACvBqB,EAAgBf,KAAO,aACvBe,EAAgBC,iBAAiB,SAAUC,IACzCA,EAAEC,iBACFN,EAAInB,cAAc,gBAAgB0B,UAAUC,OAAO,SAAS,IAM9DR,EAAIS,iBAAiB,UAAUC,SAASC,IACtC,MAEMC,EAFKD,EAAEE,cAEMhC,cAAc,eAC7B+B,GACFD,EAAEP,iBAAiB,SAAUC,IAC0B,SAAjD9B,OAAOuC,iBAAiBb,GAAac,UACvCV,EAAEC,iBACFM,EAAQL,UAAUC,OAAO,UAC1B,GAEJ,IAIHQ,EAAgBhB,EAClB,CAuCMiB,CAAgBjB,EACjB,CACF,CACH"}