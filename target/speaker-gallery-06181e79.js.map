{"version":3,"file":"speaker-gallery-06181e79.js","sources":["../blocks/speaker-gallery/speaker-gallery.js"],"sourcesContent":["import { createOptimizedPicture, readBlockConfig } from '../../scripts/lib-franklin.js';\nimport { getQueryIndex } from '../../scripts/services/QueryIndex.js';\nimport { append } from '../../scripts/utils/dom.js';\nimport { parseCSVArray } from '../../scripts/utils/metadata.js';\nimport { getSiteRootPath, getSpeakerDetailPath } from '../../scripts/utils/site.js';\n\n/**\n * Create speaker image (or fallback image);\n * @typedef {import('../../scripts/services/QueryIndexItem').default} QueryIndexItem\n * @param {QueryIndexItem} speakerItem Speaker item\n * @param {boolean} eager Use eager loading for image\n */\nfunction createSpeakerImage(speakerItem, eager) {\n  if (speakerItem.image) {\n    return createOptimizedPicture(\n      speakerItem.image,\n      speakerItem.title,\n      eager,\n      [{ width: '500' }],\n    );\n  }\n\n  // fallback image\n  const img = document.createElement('img');\n  img.src = '/resources/img/speaker_placeholder.svg';\n  return img;\n}\n\n/**\n * Add markup for speaker\n * @typedef {import('../../scripts/services/QueryIndex').default} QueryIndex\n * @param {Element} parent Parent element\n * @param {string} speaker Speaker name or reference\n * @param {number} speakerIndex Index of speaker in list\n * @param {string} siteRootPath Site root path\n * @param {QueryIndex} queryIndex Query index\n */\nfunction addSpeaker(parent, speaker, speakerIndex, siteRootPath, queryIndex) {\n  const speakerItem = queryIndex.getSpeaker(speaker, siteRootPath);\n  if (!speakerItem) {\n    return;\n  }\n\n  const speakerUrl = getSpeakerDetailPath(speakerItem, siteRootPath);\n\n  const div = append(parent, 'div', 'speaker');\n\n  const imageAnchor = append(div, 'a');\n  imageAnchor.href = speakerUrl;\n  const eagerImage = (speakerIndex <= 3); // use eager loading for first 4 speaker images\n  imageAnchor.append(createSpeakerImage(speakerItem, eagerImage));\n\n  const nameDiv = append(div, 'div', 'name');\n  const a = append(nameDiv, 'a');\n  a.href = speakerUrl;\n  a.textContent = speakerItem.title;\n\n  if (speakerItem.twitter) {\n    const twitterDiv = append(div, 'div', 'twitter');\n    const twitterAnchor = append(twitterDiv, 'a');\n    twitterAnchor.textContent = speakerItem.twitter;\n    twitterAnchor.href = `https://twitter.com/${speakerItem.twitter}`;\n  }\n\n  if (speakerItem.affiliation) {\n    const affiliationDiv = append(div, 'div', 'affiliation');\n    affiliationDiv.textContent = speakerItem.affiliation;\n  }\n}\n\n/**\n * List speakers.\n * @typedef {import('../../scripts/services/QueryIndex').default} QueryIndex\n * @param {Element} parent Parent element\n * @param {string[]} speakers Speaker names or references\n * @param {string} siteRootPath Site root path\n * @param {QueryIndex} queryIndex Query index\n */\nfunction addSpeakers(parent, speakers, siteRootPath, queryIndex) {\n  if (speakers.length === 0) {\n    return;\n  }\n\n  const div = append(parent, 'div', 'speakers');\n  speakers.forEach((speaker, speakerIndex) => addSpeaker(\n    div,\n    speaker,\n    speakerIndex,\n    siteRootPath,\n    queryIndex,\n  ));\n}\n\n/**\n * List lightning talk speakers.\n * @param {Element} parent Parent element\n * @param {string[]} speakers Speaker names or references\n * @param {string} siteRootPath Site root path\n * @param {QueryIndex} queryIndex Query index\n */\nfunction addLightningTalkSpeakers(parent, speakers, siteRootPath, queryIndex) {\n  if (speakers.length === 0) {\n    return;\n  }\n  const h4 = append(parent, 'h4');\n  h4.textContent = 'Additional speakers (Lightning Talks)';\n\n  const div = append(parent, 'div', 'speakers', 'lightning-talk');\n  speakers.forEach((speaker, speakerIndex) => addSpeaker(\n    div,\n    speaker,\n    speakerIndex,\n    siteRootPath,\n    queryIndex,\n  ));\n}\n\n/**\n * Speaker Gallery.\n * @param {Element} block\n */\nexport default async function decorate(block) {\n  const cfg = readBlockConfig(block);\n  block.textContent = '';\n\n  const siteRoot = getSiteRootPath(document.location.pathname);\n  const queryIndex = await getQueryIndex();\n\n  // check for list of speakers from block config\n  const speakers = parseCSVArray(cfg.speakers);\n  if (speakers.length > 0) {\n    addSpeakers(block, speakers, siteRoot, queryIndex);\n\n  // otherwise render gallery with all speakers in the schedule\n  } else {\n    // get all speakers from schedule\n    addSpeakers(block, queryIndex.getTalkSpeakerNames(siteRoot), siteRoot, queryIndex);\n    addLightningTalkSpeakers(\n      block,\n      queryIndex.getLightningTalkSpeakerNames(siteRoot),\n      siteRoot,\n      queryIndex,\n    );\n  }\n}\n"],"names":["addSpeaker","parent","speaker","speakerIndex","siteRootPath","queryIndex","speakerItem","getSpeaker","speakerUrl","getSpeakerDetailPath","div","append","imageAnchor","href","eagerImage","eager","image","createOptimizedPicture","title","width","img","document","createElement","src","createSpeakerImage","nameDiv","a","textContent","twitter","twitterDiv","twitterAnchor","affiliation","addSpeakers","speakers","length","forEach","async","decorate","block","cfg","readBlockConfig","siteRoot","getSiteRootPath","location","pathname","getQueryIndex","parseCSVArray","getTalkSpeakerNames","addLightningTalkSpeakers","getLightningTalkSpeakerNames"],"mappings":"iEAqCA,SAASA,EAAWC,EAAQC,EAASC,EAAcC,EAAcC,GAC/D,MAAMC,EAAcD,EAAWE,WAAWL,EAASE,GACnD,IAAKE,EACH,OAGF,MAAME,EAAaC,EAAqBH,EAAaF,GAE/CM,EAAMC,EAAOV,EAAQ,MAAO,WAE5BW,EAAcD,EAAOD,EAAK,KAChCE,EAAYC,KAAOL,EACnB,MAAMM,EAAcX,GAAgB,EACpCS,EAAYD,OAtCd,SAA4BL,EAAaS,GACvC,GAAIT,EAAYU,MACd,OAAOC,EACLX,EAAYU,MACZV,EAAYY,MACZH,EACA,CAAC,CAAEI,MAAO,SAKd,MAAMC,EAAMC,SAASC,cAAc,OAEnC,OADAF,EAAIG,IAAM,yCACHH,CACT,CAwBqBI,CAAmBlB,EAAaQ,IAEnD,MAAMW,EAAUd,EAAOD,EAAK,MAAO,QAC7BgB,EAAIf,EAAOc,EAAS,KAI1B,GAHAC,EAAEb,KAAOL,EACTkB,EAAEC,YAAcrB,EAAYY,MAExBZ,EAAYsB,QAAS,CACvB,MAAMC,EAAalB,EAAOD,EAAK,MAAO,WAChCoB,EAAgBnB,EAAOkB,EAAY,KACzCC,EAAcH,YAAcrB,EAAYsB,QACxCE,EAAcjB,KAAO,uBAAuBP,EAAYsB,SACzD,CAED,GAAItB,EAAYyB,YAAa,CACJpB,EAAOD,EAAK,MAAO,eAC3BiB,YAAcrB,EAAYyB,WAC1C,CACH,CAUA,SAASC,EAAY/B,EAAQgC,EAAU7B,EAAcC,GACnD,GAAwB,IAApB4B,EAASC,OACX,OAGF,MAAMxB,EAAMC,EAAOV,EAAQ,MAAO,YAClCgC,EAASE,SAAQ,CAACjC,EAASC,IAAiBH,EAC1CU,EACAR,EACAC,EACAC,EACAC,IAEJ,CA8Be+B,eAAeC,EAASC,GACrC,MAAMC,EAAMC,EAAgBF,GAC5BA,EAAMX,YAAc,GAEpB,MAAMc,EAAWC,EAAgBrB,SAASsB,SAASC,UAC7CvC,QAAmBwC,IAGnBZ,EAAWa,EAAcP,EAAIN,UAC/BA,EAASC,OAAS,EACpBF,EAAYM,EAAOL,EAAUQ,EAAUpC,IAKvC2B,EAAYM,EAAOjC,EAAW0C,oBAAoBN,GAAWA,EAAUpC,GApC3E,SAAkCJ,EAAQgC,EAAU7B,EAAcC,GAChE,GAAwB,IAApB4B,EAASC,OACX,OAESvB,EAAOV,EAAQ,MACvB0B,YAAc,wCAEjB,MAAMjB,EAAMC,EAAOV,EAAQ,MAAO,WAAY,kBAC9CgC,EAASE,SAAQ,CAACjC,EAASC,IAAiBH,EAC1CU,EACAR,EACAC,EACAC,EACAC,IAEJ,CAsBI2C,CACEV,EACAjC,EAAW4C,6BAA6BR,GACxCA,EACApC,GAGN"}